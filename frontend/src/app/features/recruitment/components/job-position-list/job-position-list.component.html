<div class="job-position-list">
  <div class="page-header">
    <h1>Postes d'Emploi</h1>
    <app-button
      *ngIf="canCreate()"
      variant="primary"
      routerLink="/recruitment/positions/create"
    >
      Créer un poste
    </app-button>
  </div>

  <app-loading *ngIf="loading()" message="Chargement des postes..."></app-loading>

  <div *ngIf="!loading() && positions().length === 0" class="empty-state">
    <app-card>
      <p>Aucun poste trouvé</p>
      <app-button *ngIf="canCreate()" variant="primary" routerLink="/recruitment/positions/create">
        Créer le premier poste
      </app-button>
    </app-card>
  </div>

  <div *ngIf="!loading() && positions().length > 0" class="positions-grid">
    <app-card *ngFor="let position of positions()" class="position-card" [routerLink]="['/recruitment/positions', position.id]">
      <div class="position-header">
        <h3 class="position-title">{{ position.title }}</h3>
        <span [class]="'badge ' + getStatusBadgeClass(position.status)">
          {{ position.status === 'open' ? 'Ouvert' : position.status === 'closed' ? 'Fermé' : 'En attente' }}
        </span>
      </div>
      <div class="position-content">
        <p class="position-description">{{ position.description }}</p>
        <div class="position-info">
          <span *ngIf="position.department_name">{{ position.department_name }}</span>
          <span *ngIf="position.candidates_count !== undefined">
            {{ position.candidates_count }} candidat(s)
          </span>
          <span *ngIf="position.urgency" class="urgent">Urgent</span>
        </div>
      </div>
      <div class="position-footer" *ngIf="canCreate()" (click)="$event.stopPropagation()">
        <button class="icon-button" routerLink="/recruitment/positions/{{ position.id }}/edit" aria-label="Modifier">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
            <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7" stroke="currentColor" stroke-width="2" fill="none"/>
            <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z" stroke="currentColor" stroke-width="2" fill="none"/>
          </svg>
        </button>
        <button class="icon-button danger" (click)="deletePosition(position.id)" aria-label="Supprimer">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
            <path d="M3 6h18M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2" stroke="currentColor" stroke-width="2" fill="none"/>
          </svg>
        </button>
      </div>
    </app-card>
  </div>
</div>

